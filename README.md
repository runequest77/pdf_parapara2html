# PDF ParaPara2Html  
- 英文のPDF を段組みや囲み記事などの文章構造を解析し、読み順に整えた HTML を生成するツールです！
- 後から別の書式に成形しやすいように、Htmlタグに元のフォント情報も保持しています。
- 自分でテキストを成形したい方もいるかもしれないため、構造を保ったJSONデータも出力します。
---

## 特徴
**簡単！ドラッグ＆ドロップで変換**  
- `.exe` に **PDF をドラッグ＆ドロップ** するだけ！  

**JSON + HTML の2種類を出力**  
- **JSON**: ページ構造を保持したデータ。
- **HTML**: 構造を確認しやすい形で整形したHTMLです。  

**OCRはできません。文字が埋め込まれている英文PDFが対象です**  

---

## **🛠 使い方**
1. **[GitHub Releases](https://github.com/memo77/releases) から `.exe` をダウンロード**  
2. **変換したい PDF を `.exe` にドラッグ＆ドロップ**  
3. **PDF と同じフォルダに `PDF名.json` と `PDF名.html` が生成されます。**  

---
# 一部の方々向け情報
TRPGの英語サプリメントを日本語に翻訳するために作成したものです。</br>
TRPGのルールブックは文章だけだと読み取りにくいため、画面上でPDFと原文と訳文を並べて表示できる「PDF ParaParaTran」を作成中です。</br>
まだ未完成ですが、英文だけでもきれいに抽出したいという方がいるようなので、最初の解析部分だけ抜き出したのがPDF ParaPara2Htmlです。</br>

---

# 技術詳細（興味のある方向け
## 段組み（カラム）の検出
1. **テキストブロックのバウンディングボックス（`bbox`）を取得**  
2. **ページ幅を基準に「大きな隙間」を解析し、カラムを分離**  
3. **見出しや横断テキストを特別処理し、適切な順序に配置**  
4. **行間のギャップ解析** → **一定の間隔を超えると新しい段落と判断**  

## パラグラフの終了判定
1. 英文PDFの特徴として行末にスペースがある場合はパラグラフを閉じない。  
2. 「行末が句読点（. ! ?）」ならパラグラフを閉じる 。
3. 文中に混ざるタブは|に置換  
5. フォントサイズ・スタイルが変化するごとにスパンタグで括り、スタイルの事後設定を可能に。  

## 技術スタック
- **`PyMuPDF`（MuPDF）** → PDF の解析  
- **独自アルゴリズム** → カラム検出 & 段落分割  
